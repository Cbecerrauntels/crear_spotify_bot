(CÓDIGO DEL ARCHIVO .py, ver respuesta anterior para el código completo)